#!/bin/bash
actions=(
  'suspend'
  'screen'
  'reboot'
  'shutdown'
  'logout'
)

lock() {
  i3lock -c 000000
}

select_action() {
  case $1 in
    screen )
      sleep 1 && xset dpms force off ;;
    suspend )
      # x=$(( $(  wmctrl -d | head -n1 | awk '{ print $4 }' | awk -F'x' '{ print $1 }' ) - 40 ))
      # xdotool mousemove $x 10 && xdotool click 1 && xdotool mousemove $x 37 && sleep 0.5s && xdotool click 1
      lock
      dbus-send --system --print-reply --dest="org.freedesktop.UPower" /org/freedesktop/UPower org.freedesktop.UPower.Suspend ;;
    reboot )
      dbus-send --system --print-reply --dest="org.freedesktop.ConsoleKit" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Restart ;;
    shutdown )
      dbus-send --system --print-reply --dest="org.freedesktop.ConsoleKit" /org/freedesktop/ConsoleKit/Manager org.freedesktop.ConsoleKit.Manager.Stop ;;
    logout )
      i3-msg exit ;;
  esac
}

if [[ $1 ]]; then
  select_action "$1"
else
  select_action "$( printf "%s\n" "${actions[@]}" | rofi -dmenu -i -p 'â†  ' -hlbg '#4F5A0B' -bc '#4F5A0B' )"
fi
